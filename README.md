# Telegram2Notion: Умный Ассистент

Это не просто бот, а полноценный ассистент для Notion, который позволяет на лету сохранять идеи, задачи и ссылки, а также интерактивно заполнять свойства для задач, делая его максимально интегрированным в ваш рабочий процесс.

## Ключевые Возможности

-   **Полная Настройка под Вашу Структуру Notion**: Вы можете задать любые названия для колонок (свойств) в ваших базах данных прямо в файле конфигурации.
-   **Интерактивное Создание Задач**: При создании задачи бот последовательно задаст вам вопросы для заполнения важных полей (например, "Тип", "Важность", "Статус"), предлагая варианты выбора в виде кнопок. Варианты подгружаются прямо из вашей базы Notion!
-   **Интеллектуальный Анализ Ссылок**: Отправьте боту ссылку, и он сам извлечет контент, напишет краткое саммари и заголовок с помощью OpenAI, а также добавит теги.
-   **Транскрипция Голосовых Сообщений**: Любое голосовое сообщение будет автоматически расшифровано через OpenAI Whisper и сохранено как текст.

## Установка и Настройка

### 1. Клонирование и зависимости
```bash
git clone [адрес_вашего_репозитория]
cd [имя_папки]
# Установите ffmpeg (для Debian/Ubuntu)
sudo apt update && sudo apt install ffmpeg
# Создайте и активируйте виртуальное окружение
python3 -m venv venv
source venv/bin/activate
# Установите зависимости
pip install -r requirements.txt
```

### 2. Конфигурация (`.env` файл)

Это самый важный шаг. Скопируйте `.env.example` в `.env` и внимательно заполните его.

#### Основные Токены и ID Баз
-   `TELEGRAM_TOKEN`: Токен вашего бота от @BotFather.
-   `OPENAI_API_KEY`: Ваш ключ от OpenAI.
-   `NOTION_TOKEN`: Внутренний токен интеграции Notion.
-   `NOTION_DATABASE_ID_IDEA`: ID базы данных для "Идей".
-   `NOTION_DATABASE_ID_TASK`: ID базы данных для "Задач".
-   `NOTION_DATABASE_ID_LINK`: ID базы данных для "Ссылок".

#### Настройка Названий Свойств (Колонок)
Этот блок позволяет вам указать точные названия колонок в ваших базах данных. **Если названия у вас стандартные, вы можете не менять эти строки.**

-   `NOTION_IDEA_PROPERTY_TITLE`: Название колонки `Title` в базе "Идеи" (по умолчанию: `Name`).
-   `NOTION_TASK_PROPERTY_TITLE`: Название колонки `Title` в базе "Задачи" (по умолчанию: `Name`).
-   `NOTION_LINK_PROPERTY_TITLE`: Название колонки `Title` в базе "Ссылки" (по умолчанию: `Name`).
-   `NOTION_LINK_PROPERTY_URL`: Название колонки `URL` в базе "Ссылки" (по умолчанию: `URL`).
-   `NOTION_LINK_PROPERTY_TAGS`: Название колонки `Multi-select` для тегов в базе "Ссылки" (по умолчанию: `Tags`).

#### Настройка Интерактивных Полей для Задач
-   `NOTION_TASK_INTERACTIVE_PROPERTIES`: **Ключевая настройка!** Перечислите здесь через запятую точные названия колонок типа `Select` или `Multi-select` из вашей базы "Задачи", которые вы хотите, чтобы бот предлагал заполнить.
    -   *Пример:* `NOTION_TASK_INTERACTIVE_PROPERTIES=Статус,Приоритет,Тип задачи`
    -   Бот будет задавать вопросы в том порядке, в котором вы их здесь перечислили. Если оставить пустым, интерактивный режим не будет запущен.

## Как Пользоваться

1.  **Запустите бота** на сервере (`sudo systemctl start telegram_bot` если настроили сервис, или `python bot.py` для теста).
2.  **Отправьте команду `/start`** в чат с ботом.
3.  **Выберите действие:**
    -   **Идея**: Отправьте текст или голосовое. Идея будет сохранена.
    -   **Ссылка**: Отправьте URL. Бот проанализирует его и сохранит.
    -   **Задача**: Отправьте текст или голосовое с названием задачи. Бот создаст задачу и начнет задавать вам уточняющие вопросы, предлагая кнопки с вариантами из вашей базы Notion. Отвечайте на них, чтобы заполнить все нужные поля.
4.  Для отмены любой операции используйте команду `/cancel`.
